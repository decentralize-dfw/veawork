<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VEA | BOOK A SESSION</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @font-face {
            font-family: 'Telegrama Render';
            src: url('https://raw.githubusercontent.com/decentralize-dfw/font/main/vea.ttf') format('truetype');
            font-display: block;
        }
        :root { 
            --ui-color: #000000; 
            --bg-color: #ffffff; 
            --font-main: 'Telegrama Render', sans-serif; 
        }
        
        body, html { 
            margin: 0; padding: 0; 
            font-family: var(--font-main); 
            background-color: var(--bg-color); 
            color: var(--ui-color); 
            height: 100vh; 
            width: 100%;
            overflow: hidden; /* Sayfa genelinde kaydırma kesinlikle kapalı */
        }
        
        .vea-panel { 
            background: rgba(255, 255, 255, 0.85); 
            backdrop-filter: blur(20px); 
            -webkit-backdrop-filter: blur(20px); 
            border: 1px solid rgba(0, 0, 0, 0.1); 
            border-radius: 24px; 
            width: 90%; 
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Calendar Grid Scaling */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; }
        .calendar-day { 
            aspect-ratio: 1; display: flex; align-items: center; justify-content: center; 
            border-radius: 50%; cursor: pointer; font-size: 0.65rem; transition: all 0.2s ease; 
            border: 1px solid transparent; width: 100%;
        }
        .calendar-day:hover:not(.disabled) { background: #f0f0f0; border-color: var(--ui-color); }
        .calendar-day.selected { background: var(--ui-color); color: white; }
        .calendar-day.disabled { opacity: 0.1; cursor: not-allowed; }

        /* General UI Elements */
        .time-slot { 
            padding: 10px 0; border: 1px solid rgba(0,0,0,0.1); border-radius: 12px; 
            text-align: center; cursor: pointer; font-size: 0.6rem; transition: all 0.2s ease; 
            width: 100%; 
        }
        .time-slot:hover { border-color: var(--ui-color); background: #fafafa; }
        .time-slot.selected { background: var(--ui-color); color: white; border-color: var(--ui-color); }

        .option-chip { 
            border: 1px solid rgba(0,0,0,0.1); padding: 4px 8px; border-radius: 8px; 
            cursor: pointer; font-size: 0.55rem; text-transform: uppercase;
        }
        .option-chip.active { background: var(--ui-color); color: white; }

        input, textarea { 
            background: transparent; border: 1px solid rgba(0,0,0,0.1); border-radius: 10px; 
            padding: 8px 12px; width: 100% !important; font-family: inherit; outline: none; box-sizing: border-box; 
            font-size: 0.7rem !important;
        }

        .service-chip { 
            border: 1px solid rgba(0,0,0,0.1); padding: 4px 10px; border-radius: 15px; 
            cursor: pointer; font-size: 0.5rem; text-transform: uppercase; 
        }
        .service-chip.active { background: var(--ui-color); color: white; }

        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-runnable-track { height: 2px; background: #eee; }
        input[type=range]::-webkit-slider-thumb { height: 14px; width: 14px; border-radius: 50%; background: var(--ui-color); -webkit-appearance: none; margin-top: -6px; }

        .submit-btn { 
            background: var(--ui-color); color: white; padding: 12px; border-radius: 12px; 
            width: 100%; text-transform: uppercase; letter-spacing: 2px; font-size: 0.7rem; 
        }
        .nav-btn { cursor: pointer; padding: 5px; opacity: 0.5; }
        
        @media (max-width: 768px) { 
            .desktop-only { display: none !important; }
            .vea-panel { 
                width: 95%; 
                padding: 1.5rem !important; 
                height: auto;
                max-height: 80vh;
            } 
            h1 { font-size: 1.3rem !important; margin: 10px 0 !important; } 
            
            /* Step 1 Inner Slider for Mobile */
            .mobile-step1-slider {
                display: flex;
                overflow-x: auto;
                scroll-snap-type: x mandatory;
                scroll-behavior: smooth;
                -webkit-overflow-scrolling: touch;
                width: 100%;
            }
            .mobile-step1-slider > div {
                flex: 0 0 100%;
                scroll-snap-align: start;
                padding: 0 5px;
                box-sizing: border-box;
            }
            .mobile-step1-slider::-webkit-scrollbar { display: none; }
            
            /* Slots Layout for Mobile */
            .time-slots-grid {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 5px;
            }

            .info-section { margin-bottom: 0 !important; padding-bottom: 0 !important; }
            .chips-wrapper { max-height: 70px; overflow-y: auto; gap: 4px; }
        }

        /* Desktop Layout (Stay untouched) */
        @media (min-width: 769px) {
            .time-slots-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            /* Büyütülmüş Desktop Logo ve Başlık */
            .desktop-logo { width: 320px !important; margin-bottom: 40px !important; }
            .desktop-title { font-size: 4rem !important; line-height: 0.95 !important; }
        }
        
        .fade-in { animation: fadeIn 0.3s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="flex flex-col items-center justify-center h-screen p-4 overflow-hidden">

    <div class="w-full max-w-6xl grid grid-cols-1 md:grid-cols-12 gap-4 md:gap-10 h-full items-center">
        <!-- INFO SECTION -->
        <div class="md:col-span-4 flex flex-col justify-center info-section text-center md:text-left">
            <div class="mb-2">
                <img src="https://raw.githubusercontent.com/decentralize-dfw/vea-files/main/veacrop.png" class="desktop-only desktop-logo mb-10" alt="VEA Logo">
                <h1 class="font-bold uppercase desktop-title">BOOK A <br class="hidden md:block">SESSION</h1>
                <p class="text-[10px] md:text-xs opacity-60 leading-relaxed uppercase text-black mt-4">
                    VEA craft environments where imagination, materiality, and motion converge into a new form of experience.

Every project becomes its own world. 
                    
                </p>
            </div>
            <div class="mt-1 md:mt-10">
                <div class="flex items-center justify-center md:justify-start gap-2">
                    <span class="w-1.5 h-1.5 rounded-full bg-green-500"></span>
                    <span class="text-[8px] md:text-[10px] uppercase font-bold tracking-widest">LUXEMBOURG (GMT+1)</span>
                </div>
            </div>
        </div>

        <!-- MAIN PANEL -->
        <div class="md:col-span-8 vea-panel p-6 md:p-10 shadow-2xl overflow-hidden">
            <form id="bookingForm" class="w-full h-full flex flex-col">
                
                <!-- STEP 1: CALENDAR & TIME (SEQUENTIAL ON MOBILE) -->
                <div id="step1" class="space-y-4 md:space-y-8 fade-in h-full flex flex-col">
                    <div class="mobile-step1-slider md:grid md:grid-cols-2 gap-4 md:gap-8 flex-1 overflow-hidden">
                        
                        <!-- Slide 1: Calendar -->
                        <div class="w-full">
                            <h3 class="text-[10px] font-bold uppercase mb-2 tracking-widest text-center md:text-left">1. PICK DATE</h3>
                            <div class="flex justify-between items-center mb-2">
                                <span class="nav-btn text-[10px]" onclick="changeMonth(-1)">◀</span>
                                <h3 id="monthText" class="text-[9px] font-bold uppercase tracking-widest text-center flex-1"></h3>
                                <span class="nav-btn text-[10px]" onclick="changeMonth(1)">▶</span>
                            </div>
                            <div class="calendar-grid mb-1 opacity-30 text-[6px] uppercase font-bold text-center">
                                <div>Mo</div><div>Tu</div><div>We</div><div>Th</div><div>Fr</div><div>Sa</div><div>Su</div>
                            </div>
                            <div id="calendarDays" class="calendar-grid w-full"></div>
                            
                            <!-- Mobile-only hint -->
                            <p class="md:hidden text-[7px] opacity-40 text-center mt-3 uppercase tracking-widest">Swipe right for time slots ⮕</p>
                        </div>
                        
                        <!-- Slide 2: Duration & Slots -->
                        <div class="w-full flex flex-col space-y-4">
                            <h3 class="text-[10px] font-bold uppercase mb-2 tracking-widest text-center md:text-left">2. PICK TIME</h3>
                            <div>
                                <h3 class="text-[8px] font-bold uppercase mb-2 opacity-50">DURATION</h3>
                                <div class="flex flex-wrap gap-2" id="durationSelection">
                                    <div class="option-chip active" data-val="15 min">15 min</div>
                                    <div class="option-chip" data-val="30 min">30 min</div>
                                    <div class="option-chip" data-val="45 min">45 min</div>
                                </div>
                                <input type="hidden" name="duration" id="durationInput" value="15 min">
                            </div>
                            <div class="flex-1 overflow-hidden">
                                <h3 class="text-[8px] font-bold uppercase mb-2 opacity-50">SLOTS</h3>
                                <div id="timeSlots" class="time-slots-grid max-h-[160px] md:max-h-[220px] overflow-y-auto pr-1">
                                    <p class="text-[9px] opacity-40 uppercase italic w-full text-center">Pick a date first...</p>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Step 1 Footer -->
                    <div id="nextAction" class="mt-auto pt-2 flex justify-end">
                        <button type="button" id="proceedBtn" onclick="proceedStep()" class="submit-btn max-w-[140px] md:max-w-[200px] opacity-30 cursor-not-allowed w-full md:w-auto" disabled>NEXT STEP</button>
                    </div>
                </div>

                <!-- STEP 2: DETAILS (SHOWN AFTER PROCEED) -->
                <div id="step2" class="hidden space-y-3 md:space-y-6 pt-2 fade-in h-full flex flex-col">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                        <div class="space-y-1">
                            <label class="text-[7px] uppercase font-bold opacity-40">FULL NAME *</label>
                            <input type="text" name="name" placeholder="YOUR NAME" required>
                        </div>
                        <div class="space-y-1">
                            <label class="text-[7px] uppercase font-bold opacity-40">EMAIL ADDRESS *</label>
                            <input type="email" name="email" placeholder="YOUR EMAIL" required>
                        </div>
                    </div>
                    
                    <div class="space-y-2">
                        <p class="text-[8px] uppercase font-bold tracking-widest">SERVICES</p>
                        <div class="chips-wrapper flex flex-wrap gap-1" id="serviceSelection">
                            <div class="service-chip" data-val="Worldbuilding">Worldbuilding</div>
                            <div class="service-chip" data-val="Spatial Interfaces">Spatial</div>
                            <div class="service-chip" data-val="Atmospheric Objects">Atmospheric</div>
                            <div class="service-chip" data-val="Identity Building">Identity</div>
                            <div class="service-chip" data-val="Logo Design">Logo</div>
                            <div class="service-chip" data-val="Website Design">Website</div>
                            <div class="service-chip" data-val="Cinematic Reels">Reels</div>
                            <div class="service-chip" data-val="Visual Storytelling">Storytelling</div>
                        </div>
                        <input type="hidden" name="services" id="servicesInput">
                    </div>

                    <div class="space-y-1">
                        <p class="text-[8px] uppercase font-bold tracking-widest">MESSAGE</p>
                        <textarea name="message" rows="2" placeholder="Your dreams..."></textarea>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <div class="flex justify-between items-center">
                                <p class="text-[8px] uppercase font-bold tracking-widest">BUDGET</p>
                                <span id="budgetVal" class="text-[8px] font-bold">$1,000</span>
                            </div>
                            <input type="range" name="budget" id="budgetSlider" min="1000" max="50000" step="1000" value="1000">
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between items-center">
                                <p class="text-[8px] uppercase font-bold tracking-widest">TIMELINE</p>
                                <span id="timeVal" class="text-[8px] font-bold">1 Week</span>
                            </div>
                            <input type="range" name="timeline" id="timeSlider" min="1" max="30" step="1" value="1">
                        </div>
                    </div>

                    <input type="hidden" name="appointment_date" id="finalDateInput">
                    <input type="hidden" name="appointment_time" id="finalTimeInput">

                    <div class="pt-2 mt-auto">
                        <button type="submit" class="submit-btn mb-2">CONFIRM APPOINTMENT</button>
                        <button type="button" onclick="goBack()" class="text-[7px] uppercase underline opacity-40 w-full text-center">Back to Step 1</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- SUCCESS OVERLAY -->
    <div id="successOverlay" class="fixed inset-0 bg-white z-[100] flex flex-col items-center justify-center text-center p-6 hidden">
        <h2 class="text-2xl md:text-4xl font-bold uppercase mb-4">SUCCESS</h2>
        <p class="text-[10px] opacity-60 uppercase mb-8 leading-relaxed max-w-xs text-center">Request sent to Deniz.</p>
        <button onclick="location.reload()" class="underline text-[10px] uppercase tracking-widest">BACK</button>
    </div>

    <script>
        const formspree_id = "mlgeweob";
        let selectedDate = null;
        let selectedTime = null;
        let selectedServices = [];
        let currentDisplayDate = new Date();

        const daysContainer = document.getElementById('calendarDays');
        const timeSlotsContainer = document.getElementById('timeSlots');
        const monthHeader = document.getElementById('monthText');
        const proceedBtn = document.getElementById('proceedBtn');
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');

        function renderCalendar(date) {
            const year = date.getFullYear();
            const month = date.getMonth();
            const monthNames = ["JANUARY", "FEBRUARY", "MARCH", "APRIL", "MAY", "JUNE", "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER"];
            monthHeader.innerText = `${monthNames[month]} ${year}`;
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const startDay = firstDay === 0 ? 6 : firstDay - 1;
            daysContainer.innerHTML = '';
            for (let i = 0; i < startDay; i++) daysContainer.appendChild(document.createElement('div'));
            const now = new Date(); now.setHours(0,0,0,0);
            for (let d = 1; d <= daysInMonth; d++) {
                const dayEl = document.createElement('div');
                const checkDate = new Date(year, month, d);
                dayEl.className = 'calendar-day';
                dayEl.innerText = d;
                if (checkDate < now) dayEl.classList.add('disabled');
                else {
                    if (selectedDate === `${d} ${monthNames[month]} ${year}`) dayEl.classList.add('selected');
                    dayEl.onclick = () => {
                        document.querySelectorAll('.calendar-day').forEach(cd => cd.classList.remove('selected'));
                        dayEl.classList.add('selected');
                        selectedDate = `${d} ${monthNames[month]} ${year}`;
                        document.getElementById('finalDateInput').value = selectedDate;
                        generateTimeSlots();
                        validateStep1();
                        
                        if (window.innerWidth <= 768) {
                            document.querySelector('.mobile-step1-slider').scrollLeft = window.innerWidth;
                        }
                    };
                }
                daysContainer.appendChild(dayEl);
            }
        }

        function generateTimeSlots() {
            timeSlotsContainer.innerHTML = '';
            const hours = ["11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00"];
            hours.forEach(h => {
                const slot = document.createElement('div');
                slot.className = 'time-slot';
                slot.innerText = h;
                if (selectedTime === h) slot.classList.add('selected');
                slot.onclick = () => {
                    document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
                    slot.classList.add('selected');
                    selectedTime = h;
                    document.getElementById('finalTimeInput').value = selectedTime;
                    validateStep1();
                };
                timeSlotsContainer.appendChild(slot);
            });
        }

        function validateStep1() {
            if (selectedDate && selectedTime) {
                proceedBtn.disabled = false;
                proceedBtn.classList.remove('opacity-30', 'cursor-not-allowed');
            }
        }

        window.changeMonth = (delta) => {
            currentDisplayDate.setMonth(currentDisplayDate.getMonth() + delta);
            renderCalendar(currentDisplayDate);
        };

        window.proceedStep = () => {
            if (selectedDate && selectedTime) {
                step1.classList.add('hidden');
                step2.classList.remove('hidden');
            }
        };

        window.goBack = () => {
            step1.classList.remove('hidden');
            step2.classList.add('hidden');
        };

        document.querySelectorAll('#durationSelection .option-chip').forEach(chip => {
            chip.onclick = () => {
                document.querySelectorAll('#durationSelection .option-chip').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                document.getElementById('durationInput').value = chip.getAttribute('data-val');
            };
        });

        const budgetSlider = document.getElementById('budgetSlider');
        const budgetVal = document.getElementById('budgetVal');
        budgetSlider.oninput = function() { budgetVal.innerText = `$${parseInt(this.value).toLocaleString()}`; };

        const timeSlider = document.getElementById('timeSlider');
        const timeVal = document.getElementById('timeVal');
        timeSlider.oninput = function() {
            const weeks = parseInt(this.value);
            if (weeks <= 4) timeVal.innerText = `${weeks} Week${weeks > 1 ? 's' : ''}`;
            else {
                const months = Math.floor(weeks / 4);
                const remain = weeks % 4;
                timeVal.innerText = `${months} Month${months > 1 ? 's' : ''} ${remain > 0 ? remain + ' Week' : ''}`;
            }
        };

        document.querySelectorAll('#serviceSelection .service-chip').forEach(chip => {
            chip.onclick = () => {
                const val = chip.getAttribute('data-val');
                if (selectedServices.includes(val)) {
                    selectedServices = selectedServices.filter(s => s !== val);
                    chip.classList.remove('active');
                } else {
                    selectedServices.push(val);
                    chip.classList.add('active');
                }
                document.getElementById('servicesInput').value = selectedServices.join(', ');
            };
        });

        document.getElementById('bookingForm').onsubmit = async (e) => {
            e.preventDefault();
            const submitBtn = e.target.querySelector('.submit-btn');
            submitBtn.innerText = "PROCESSING...";
            submitBtn.disabled = true;
            try {
                const formData = new FormData(e.target);
                const response = await fetch(`https://formspree.io/f/${formspree_id}`, {
                    method: 'POST',
                    body: formData,
                    headers: { 'Accept': 'application/json' }
                });
                if (response.ok) document.getElementById('successOverlay').classList.remove('hidden');
                else throw new Error("Provider error.");
            } catch (error) {
                submitBtn.innerText = "CONFIRM";
                submitBtn.disabled = false;
                alert(error.message);
            }
        };

        renderCalendar(currentDisplayDate);
    </script>
</body>
</html>
